1 ifpeek(49153)+peek(49154)<>21thenload"ge",8,1
2 ifpeek(49153)+peek(49154)=21thensys49152
8 dimx1,y1,x2,y2,x,y,p1,p2,p3,p4,d,g,f
9 xl=320:yl=200:dims,v,u,a,b
100 &g1,5,0
105 forr=10to100step10
110 cx=r+60:cy=r:a=r:b=int(r*5/8):gosub1000
115 next
120 fora=0to1:geta$:a=len(a$):next
130 &g0:end
140 :
1000 x=0:y=b:s=b*b:t=a*a*(2*y-1):u=2*s:v=2*a*a:e=0
1010 fori=0to1step0
1020 x1=cx+x:y1=cy+y:p1=x1>=.andx1<xl:p2=y1>=.andy1<yl
1030 x2=cx-x:y2=cy-y:p3=x2>=.andx2<xl:p4=y2>=.andy2<yl
1040 ifp1andp2then:&px1,y1
1050 ifp1andp4then:&px1,y2
1060 ifp3andp4then:&px2,y2
1070 ifp3andp2then:&px2,y1
1080 ify=.thenifx=athenreturn
1090 f=e+s:d=.
1100 g=f-t:ifabs(f)>abs(g)thenf=g:d=1
1110 g=e-t:ifabs(f)>abs(g)thenf=g:d=2
1120 e=f
1130 ifd<2thenx=x+1:s=s+u
1140 ifd>.theny=y-1:t=t-v
1150 next
